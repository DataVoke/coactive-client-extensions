{"version":3,"sources":["../src/ExtendCoactiveTypes.js"],"names":["api","loadExtension","factory","View","prototype","recordsToObjects","attachRecord","data","find","lookFor","_","utils","isFunction","console","warn","filter","close","raw","window","closeWindow","Error","recordsAsObjects","formToObjects","form","includeHiddenColumns","grouped","hierarchical","recordsAsObjectsGrouped","recordsAsObjectsHierarchical","Record","asObject","recordToObject","app","dv","tools","dictionary","valuesAsObject","itemCount","forEach","item","namedItem","property","drivingView","valueItem","value","itemAdded","Name","Definition"],"mappings":"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","sourcesContent":["export default (() => {\n    /**\n     * Extend Coactive Types API\n     * Extends the API of native Coactive types with additional helper functions.\n     * Dependencies:\n     *    api.loadExtension\n     *    api.data\n     *    api.utils\n     *    lodash (optional, for .find and .filter methods on View type)\n     */\n    api.loadExtension(\"api\", function () {\n        // Extend View with recordsToObjects function (includes keys for both Title and API Name and option to attach the underlying raw Coactive records)\n        if (!api.factory.View.prototype.recordsToObjects) {\n            api.factory.View.prototype.recordsToObjects = function (attachRecord) {\n                return api.data.recordsToObjects(this, attachRecord);\n            };\n        }\n\n        // Extend View's data with lodash find function\n        if (!api.factory.View.prototype.find) {\n            api.factory.View.prototype.find = function (lookFor) {\n                if (_ && api.utils.isFunction(_.find)) {\n                    return _.find(this.recordsToObjects(), lookFor);\n                } else {\n                    console.warn(\"Lodash is not loaded. Be sure to execute a Load Resource action configured to load the 'lodash' package as a 'npm' resource.\")\n                }\n            };\n        }\n\n        // Extend View's data with lodash filter function\n        if (!api.factory.View.prototype.filter) {\n            api.factory.View.prototype.filter = function (lookFor) {\n                if (_ && api.utils.isFunction(_.filter)) {\n                    return _.filter(this.recordsToObjects(), lookFor);\n                } else {\n                    console.warn(\"Lodash is not loaded. Be sure to execute a Load Resource action configured to load the 'lodash' package as a 'npm' resource.\")\n                }\n            };\n        }\n\n        // Extend View with close function to close its window\n        if (!api.factory.View.prototype.close) {\n            api.factory.View.prototype.close = function () {\n                if (this.raw && this.raw.window)\n                    this.raw.window.closeWindow();\n                else\n                    throw new Error(\"No raw window was found to close.\");\n            };\n        }\n\n        // Extend View with recordsAsObjects function to convert its Coactive records to JS objects (keyed only by Title)\n        if (!api.factory.View.prototype.recordsAsObjects) {\n            api.factory.View.prototype.recordsAsObjects = function () {\n                return api.data.formToObjects({\n                    form: this,\n                    includeHiddenColumns: false,\n                    grouped: false,\n                    hierarchical: false,\n                });\n            };\n        }\n\n        // Extend View with recordsAsObjects function to convert its Coactive records to JS objects, including grouping (keyed only by Title)\n        if (!api.factory.View.prototype.recordsAsObjectsGrouped) {\n            api.factory.View.prototype.recordsAsObjectsGrouped = function () {\n                return api.data.formToObjects({\n                    form: this,\n                    includeHiddenColumns: false,\n                    grouped: true,\n                    hierarchical: false,\n                });\n            };\n        }\n\n        // Extend View with recordsAsObjects function to convert its Coactive records to JS objects, including hierarchical grouping (keyed only by Title)\n        if (!api.factory.View.prototype.recordsAsObjectsHierarchical) {\n            api.factory.View.prototype.recordsAsObjectsHierarchical = function () {\n                return api.data.formToObjects({\n                    form: this,\n                    includeHiddenColumns: false,\n                    grouped: true,\n                    hierarchical: true,\n                });\n            };\n        }\n\n        // Extend Record with asObject function to convert its Coactive values to JS object keys/values\n        if (!api.factory.Record.prototype.asObject) {\n            api.factory.Record.prototype.asObject = function () {\n                return api.data.recordToObject(this);\n            };\n        }\n\n        // Extend dictionary with asObject function for easier consumption of Values\n        if (!app.dv.tools.dictionary.prototype.asObject) {\n            app.dv.tools.dictionary.prototype.asObject = function () {\n                const valuesAsObject = {};\n                let itemCount = 0;\n                this.forEach(item => {\n                    const namedItem = item.property || item.drivingView || item;\n                    const valueItem = item.property ? item.value : item;\n                    let itemAdded = false;\n                    if (namedItem.Name) {\n                        valuesAsObject[namedItem.Name] = valueItem;\n                        itemAdded = true;\n                    }\n                    if (namedItem.Definition && namedItem.Definition.Name) {\n                        valuesAsObject[namedItem.Definition.Name] = valueItem;\n                        itemAdded = true;\n                    }\n                    if (!itemAdded) {\n                        valuesAsObject[itemCount] = valueItem;\n                    }\n                    itemCount++;\n                });\n                return valuesAsObject;\n            };\n        }\n    });\n})();\n"],"file":"ExtendCoactiveTypes.js"}