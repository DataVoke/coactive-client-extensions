{"version":3,"sources":["../src/ExtendCoactiveTypes.js"],"names":["api","loadExtension","factory","View","prototype","recordsToObjects","attachRecord","data","find","lookFor","_","utils","isFunction","console","warn","filter","close","raw","window","closeWindow","Error","recordsAsObjects","formToObjects","form","includeHiddenColumns","grouped","hierarchical","recordsAsObjectsGrouped","recordsAsObjectsHierarchical","Record","asObject","recordToObject","app","dv","tools","dictionary","valuesAsObject","itemCount","forEach","item","namedItem","property","drivingView","valueItem","value","itemAdded","Name","Definition"],"mappings":"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","sourcesContent":["/**\n * Custom Action: Extend Coactive Types API\n * Extends the API of native Coactive types with additional helper functions.\n * Dependencies:\n *    api.loadExtension\n *    api.data\n *    api.utils\n *    lodash (optional, for .find and .filter methods on View type)\n */\napi.loadExtension(\"api\", function () {\n    // Extend View with recordsToObjects function (includes keys for both Title and API Name and option to attach the underlying raw Coactive records)\n    if (!api.factory.View.prototype.recordsToObjects) {\n        api.factory.View.prototype.recordsToObjects = function (attachRecord) {\n            return api.data.recordsToObjects(this, attachRecord);\n        };\n    }\n\n    // Extend View's data with lodash find function\n    if (!api.factory.View.prototype.find) {\n        api.factory.View.prototype.find = function (lookFor) {\n            if (_ && api.utils.isFunction(_.find)) {\n                return _.find(this.recordsToObjects(), lookFor);\n            } else {\n                console.warn(\"Lodash is not loaded. Be sure to execute a Load Resource action configured to load the 'lodash' package as a 'npm' resource.\")\n            }\n        };\n    }\n\n    // Extend View's data with lodash filter function\n    if (!api.factory.View.prototype.filter) {\n        api.factory.View.prototype.filter = function (lookFor) {\n            if (_ && api.utils.isFunction(_.filter)) {\n                return _.filter(this.recordsToObjects(), lookFor);\n            } else {\n                console.warn(\"Lodash is not loaded. Be sure to execute a Load Resource action configured to load the 'lodash' package as a 'npm' resource.\")\n            }\n        };\n    }\n\n    // Extend View with close function to close its window\n    if (!api.factory.View.prototype.close) {\n        api.factory.View.prototype.close = function () {\n            if (this.raw && this.raw.window)\n                this.raw.window.closeWindow();\n            else\n                throw new Error(\"No raw window was found to close.\");\n        };\n    }\n\n    // Extend View with recordsAsObjects function to convert its Coactive records to JS objects (keyed only by Title)\n    if (!api.factory.View.prototype.recordsAsObjects) {\n        api.factory.View.prototype.recordsAsObjects = function () {\n            return api.data.formToObjects({\n                form: this,\n                includeHiddenColumns: false,\n                grouped: false,\n                hierarchical: false,\n            });\n        };\n    }\n\n    // Extend View with recordsAsObjects function to convert its Coactive records to JS objects, including grouping (keyed only by Title)\n    if (!api.factory.View.prototype.recordsAsObjectsGrouped) {\n        api.factory.View.prototype.recordsAsObjectsGrouped = function () {\n            return api.data.formToObjects({\n                form: this,\n                includeHiddenColumns: false,\n                grouped: true,\n                hierarchical: false,\n            });\n        };\n    }\n\n    // Extend View with recordsAsObjects function to convert its Coactive records to JS objects, including hierarchical grouping (keyed only by Title)\n    if (!api.factory.View.prototype.recordsAsObjectsHierarchical) {\n        api.factory.View.prototype.recordsAsObjectsHierarchical = function () {\n            return api.data.formToObjects({\n                form: this,\n                includeHiddenColumns: false,\n                grouped: true,\n                hierarchical: true,\n            });\n        };\n    }\n\n    // Extend Record with asObject function to convert its Coactive values to JS object keys/values\n    if (!api.factory.Record.prototype.asObject) {\n        api.factory.Record.prototype.asObject = function () {\n            return api.data.recordToObject(this);\n        };\n    }\n\n    // Extend dictionary with asObject function for easier consumption of Values\n    if (!app.dv.tools.dictionary.prototype.asObject) {\n        app.dv.tools.dictionary.prototype.asObject = function () {\n            const valuesAsObject = {};\n            let itemCount = 0;\n            this.forEach(item => {\n                const namedItem = item.property || item.drivingView || item;\n                const valueItem = item.property ? item.value : item;\n                let itemAdded = false;\n                if (namedItem.Name) {\n                    valuesAsObject[namedItem.Name] = valueItem;\n                    itemAdded = true;\n                }\n                if (namedItem.Definition && namedItem.Definition.Name) {\n                    valuesAsObject[namedItem.Definition.Name] = valueItem;\n                    itemAdded = true;\n                }\n                if (!itemAdded) {\n                    valuesAsObject[itemCount] = valueItem;\n                }\n                itemCount++;\n            });\n            return valuesAsObject;\n        };\n    }\n});\n"],"file":"ExtendCoactiveTypes.js"}