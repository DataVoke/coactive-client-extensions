{"version":3,"sources":["../../src/api/actions.js"],"names":["api","loadExtension","actions","Object","entries","length","app","dv","actionLibrary","actionStores","execute","inlineExe","FormRequestBehaviorModes","Normal","types","OPEN_MODES","NORMAL","Hidden","HIDDEN","Modal","MODAL","Maximized","MAXIMIZED","Fail","runTaskAsync","formID","taskID","mode","Promise","resolve","reject","runTask","form","dvCore","CallActionChain","viewID","macroID","result","success","actionMessage","utils","getOpenForm","openFormAsync","then","f"],"mappings":"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","sourcesContent":["/**\n * Custom Action: Extend api.actions\n * Extends the api.actions namespace with additional helper functions.\n * Dependencies:\n *    api.loadExtension\n *    api.utils.getOpenForm\n *    api.utils.openFormAsync\n */\napi.loadExtension(\"api.actions\", () => {\n    if (!api.actions || Object.entries(api.actions).length === 0) {\n        // API shortcut to built-in and custom action library stores\n        api.actions = app.dv.actionLibrary.actionStores;\n    }\n\n    if (!api.actions.execute) {\n        // API shortcut to action library execution command\n        api.actions.execute = app.dv.actionLibrary.inlineExe;\n    }\n\n    if (!api.actions.FormRequestBehaviorModes) {\n        api.actions.FormRequestBehaviorModes = {\n            Normal: app.dv.types.OPEN_MODES.NORMAL,\n            Hidden: app.dv.types.OPEN_MODES.HIDDEN,\n            Modal: app.dv.types.OPEN_MODES.MODAL,\n            Maximized: app.dv.types.OPEN_MODES.MAXIMIZED,\n            Fail: -1,\n        };\n    }\n\n    if (!api.actions.runTaskAsync) {\n        /**\n         * Runs a form's task.\n         * @param {Object} formID                                            A numeric ID, UID or linker ({ UID: \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", Type: \"View\" }) that identifies the form.\n         * @param {number} taskID                                            A numeric ID that identifies the task.\n         * @param {number} [mode=api.actions.FormRequestBehavior.Normal]     One of the [api.actions.FormRequestBehaviorModes] to use when opening the form.\n         * @returns {Promise}                                                A promise that resolves after the task is sucessfully executed.\n         */\n        api.actions.runTaskAsync = (formID, taskID, mode = api.actions.FormRequestBehaviorModes.Normal) => {\n            return new Promise((resolve, reject) => {\n                // Function to run the task after we have the form\n                const runTask = form => {\n                    app.dv.actionLibrary.inlineExe(form, app.dv.actionLibrary.actionStores.dvCore.CallActionChain, { viewID: formID, macroID: taskID }, result => {\n                        if (result.success) {\n                            resolve();\n                        } else {\n                            reject(`The task (ID: ${taskID}) on form (ID: ${formID}) could not be executed.${result.actionMessage ? \" Action Message: \" + result.actionMessage : \"\"}`);\n                        }\n                    });\n                };\n\n                // Assume the form is already open, and find it\n                const form = api.utils.getOpenForm(formID);\n                if (form) {\n                    // We have a form, so run the task\n                    runTask(form);\n                } else {\n                    // If the form was not already open, attempt to open it unless requested to fail\n                    if (mode !== api.actions.FormRequestBehaviorModes.Fail) {\n                        api.utils.openFormAsync(formID, mode).then(f => {\n                            runTask(f);\n                        });\n                    } else {\n                        reject(`The form (ID: ${formID}) was not already open, and it could not be opened, so the task could not be run.`);\n                    }\n                }\n            });\n        };\n    }\n\n    if (!api.actions.runTask) {\n        /**\n         * Runs a form's task. Does not wait for asynchronous execution of task. Use api.actions.runTaskAsync to await.\n         * @param {Object} formID                                            A numeric ID, UID or linker ({ UID: \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", Type: \"View\" }) that identifies the form.\n         * @param {number} taskID                                            A numeric ID that identifies the task.\n         * @param {number} [mode=api.actions.FormRequestBehavior.Normal]     One of the [api.actions.FormRequestBehaviorModes] to use when opening the form.\n         */\n        api.actions.runTask = (formID, taskID, mode = api.actions.FormRequestBehaviorModes.Normal) => {\n            api.actions.runTaskAsync(formID, taskID, mode);\n        }\n    }\n\n    // TODO: Add pointer to api.actions.dvCore.[ActionName].Definition.Settings on root action for easy access in context of each action.\n});\n"],"file":"actions.js"}